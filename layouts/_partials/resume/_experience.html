{{ $prevCompany := "" }}
<div id="experience" class="section">
    <div class="section__heading">
        <h2 class="section__title">Experience</h2>
    </div>
    <div class="section__content">
        <div class="experience">
            <div class="experience__item">
            {{ range .work -}}
            {{ if and $prevCompany (ne .name $prevCompany) -}}
            </div>
            <div class="experience__item">
                <div class="experience__header">
                    <h3 class="experience__company">
                        {{ .name | safeHTML }}
                    </h3>
                    <h3 class="experience__place">{{ .location | safeHTML }}</h3>
                </div>
            {{- end }}
                <div class="experience__job">
                    <div class="experience__subheader">
                        <h3 class="experience__position">
                            {{ .position | safeHTML}}
                        </h3>
                        <h3 class="experience__date">{{ time.Format "January 2006" .startDate }} - {{ if .endDate }}{{time.Format "January 2006" .endDate }}{{ else }}Present{{ end }}</h3>
                    </div>
                    <ul>
                        {{ range .highlights }}
                        <li class="experience__bullet">{{ . | safeHTML }}</li>
                        {{ end }}
                    </ul>
                    <div class="experience__badges">
                        <ul>
                            {{ range .badges }}
                            <li class="experience__badge">{{ . }}</li>
                            {{ end }}
                        </ul>
                    </div>
                </div>
            {{- $prevCompany = .name }}
            {{- end }}
            </div>
        </div>
    </div>
</div>
